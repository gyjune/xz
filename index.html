<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>天气查询</title>
  <style>
    /* 简单样式，可自行修改 */
    .weather-box { max-width: 400px; margin: 50px auto; padding: 20px; border: 1px solid #eee; }
    input { padding: 8px; width: 200px; margin-right: 10px; }
    button { padding: 8px 16px; cursor: pointer; }
    .result { margin-top: 20px; line-height: 1.6; }
  </style>
</head>
<body>
  <div class="weather-box">
    <h3>查询天气</h3>
    <input type="text" id="cityInput" placeholder="输入城市（如：上海）">
    <button onclick="getWeather()">查询</button>
    <div class="result" id="weatherResult"></div>
  </div>

  <script>
    // 调用 Workers 后端接口（无需暴露私钥）
    async function getWeather() {
      const city = document.getElementById("cityInput").value.trim();
      const resultDom = document.getElementById("weatherResult");
      
      if (!city) {
        resultDom.innerText = "请输入城市名称！";
        return;
      }

      try {
        // 调用你绑定的 Workers 域名（后端已隐藏私钥）
        const res = await fetch(`https://zhixin.76220726.xyz?city=${encodeURIComponent(city)}`);
        const data = await res.json();

        // 解析并显示天气结果（心知天气免费版返回格式）
        if (data.results && data.results[0]) {
          const weather = data.results[0].now;
          const cityName = data.results[0].location.name;
          resultDom.innerHTML = `
            <p>城市：${cityName}</p>
            <p>天气：${weather.text}</p>
            <p>温度：${weather.temperature}℃</p>
            <p>更新时间：${data.results[0].last_update}</p>
          `;
        } else {
          resultDom.innerText = "未找到该城市天气数据！";
        }
      } catch (err) {
        resultDom.innerText = "查询失败，请重试！";
      }
    }
  </script>
</body>
</html>
